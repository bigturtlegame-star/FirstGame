<!DOCTYPE html>
<html>
<head>
  <title>Salary & Expenses Analyzer</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      max-width: 1100px;
      margin: 30px auto;
      background: linear-gradient(120deg, #ececec 0%, #f5f7fa 100%);
    }
    h2 {
      margin-bottom: 12px;
      color: #2462a0;
      letter-spacing: 1px;
    }
    label { display: block; margin: 10px 0 3px 0; }
    .hint { font-size: 12px; color: #666;}
    input[type="number"], select {
      width:120px; font-size: 1em; padding: 5px; margin-top: 3px;
      border: 1px solid #ccc; border-radius: 5px; transition: background 0.18s, outline 0.18s;
    }
    input:focus, select:focus { outline: 2px solid #318cea; background: #eef6ff; }
    .formcol, .charts, .results { box-shadow: 0 2px 8px rgba(180,180,180,0.10); border-radius: 12px; }
    .formcol { min-width:340px; margin-right:40px; background: #fff; padding:18px; }
    .charts { min-width:350px; margin-top:30px; background:#fff; padding:20px;}
    .results { margin:24px 0 0 0; background:#f6fbff; border-radius:7px; padding:15px;}
    button {
      margin-top:14px; background: #318cea; color: #fff; border: none; border-radius: 5px;
      padding: 6px 18px; font-weight: bold; cursor: pointer; transition: background 0.18s;
    }
    button:disabled { background: #ccc; color: #999; cursor: not-allowed;}
    button:hover:enabled { background: #2462a0;}
    #expenseList input { margin-right:10px; }
    ul { margin-top: 8px; }
    .charts canvas { margin-bottom: 18px; }
    .results b { color: #318cea; font-size: 1.07em; }
    .flex-wrap { display: flex; }
    .warning { color: #d12020; font-weight: bold; margin: 6px 0 0 0;}
    @media (max-width:900px) {
      .flex-wrap { flex-direction: column; }
      .formcol, .charts { min-width: unset; margin-right:0; }
    }
  </style>
</head>
<body>
  <h2>Salary & Expenses Analyzer</h2>
  <div class="flex-wrap">
    <div class="formcol">
      <form id="salaryForm" onsubmit="return false;">
        <label>
          Salary Amount:
          <input type="number" id="salaryAmount" value="1200" min="1" oninput="salaryValidate()">
        </label>
        <span id="salaryWarning" class="warning" style="display:none;"></span>
        <label>
          Salary Frequency:
          <select id="salaryFreq">
            <option value="daily">Daily</option>
            <option value="weekly" selected>Weekly</option>
            <option value="monthly">Monthly</option>
            <option value="yearly">Yearly</option>
          </select>
          <span class="hint">Enter gross salary at chosen frequency.</span>
        </label>
        <label>Savings Goal Amount:<input type="number" id="savingsAmount" value="200"></label>
        <label>
          Savings Frequency:
          <select id="savingsFreq">
            <option value="daily">Daily</option>
            <option value="weekly" selected>Weekly</option>
            <option value="monthly">Monthly</option>
            <option value="yearly">Yearly</option>
          </select>
          <span class="hint">How much you want to save at that frequency.</span>
        </label>
        <label>Expenses (adjust names/amounts):<br>
          <div id="expenseList">
            <input type="text" value="Rent" class="expName"><input type="number" value="400" class="expAmt">
            <select class="expFreq"><option>daily</option><option>weekly</option><option>monthly</option><option>yearly</option></select><br>
            <input type="text" value="Groceries" class="expName"><input type="number" value="150" class="expAmt">
            <select class="expFreq"><option>daily</option><option>weekly</option><option>monthly</option><option>yearly</option></select><br>
            <input type="text" value="Transport" class="expName"><input type="number" value="70" class="expAmt">
            <select class="expFreq"><option>daily</option><option>weekly</option><option>monthly</option><option>yearly</option></select><br>
            <input type="text" value="Utilities" class="expName"><input type="number" value="45" class="expAmt">
            <select class="expFreq"><option>daily</option><option>weekly</option><option>monthly</option><option>yearly</option></select><br>
            <input type="text" value="Eating Out" class="expName"><input type="number" value="40" class="expAmt">
            <select class="expFreq"><option>daily</option><option>weekly</option><option>monthly</option><option>yearly</option></select><br>
            <input type="text" value="Entertainment" class="expName"><input type="number" value="35" class="expAmt">
            <select class="expFreq"><option>daily</option><option>weekly</option><option>monthly</option><option>yearly</option></select><br>
          </div>
          <button type="button" onclick="addExpense()">Add Expense</button>
        </label>
        <button type="button" id="calcBtn">Calculate & Analyze</button>
      </form>
      <div class="results" id="results"></div>
    </div>
    <div class="charts">
      <canvas id="pieChart" width="320" height="220"></canvas>
      <canvas id="barChart" width="320" height="220"></canvas>
    </div>
  </div>
  <script>
    function freqToYearly(amount, freq) {
      if(freq==='daily') return amount*365;
      if(freq==='weekly') return amount*52;
      if(freq==='monthly') return amount*12;
      return amount*1;
    }
    function addExpense() {
      let el=document.createElement('div');
      el.innerHTML=
      `<input type="text" value="Other" class="expName">
      <input type="number" value="20" class="expAmt">
      <select class="expFreq"><option>daily</option><option>weekly</option><option>monthly</option><option>yearly</option></select>
      <button type="button" onclick="this.parentNode.remove();">Remove</button><br>`;
      document.getElementById('expenseList').appendChild(el);
    }
    function getExpenseColor(i, amountPerc) {
      const base=[
        '#175cab','#d73333','#2ca958','#ddc81d','#6e2eb3','#f68c20',
        '#de4eaa','#45877e','#7a5f25','#1da9a2','#b48229','#7d2fd8','#ad3232'
      ];
      let col=base[i%base.length];
      if (amountPerc<0.6) col = adjustColor(col,0.6+0.4*amountPerc);
      return col;
    }
    function adjustColor(hex, amt){
      hex=hex.replace('#','');
      let r=parseInt(hex.substring(0,2),16);
      let g=parseInt(hex.substring(2,4),16);
      let b=parseInt(hex.substring(4,6),16);
      let factor=amt;
      r=Math.round(r+(230-r)*factor);g=Math.round(g+(230-g)*factor);b=Math.round(b+(230-b)*factor);
      return `rgb(${r},${g},${b})`;
    }
    let pieChart, barChart;
    function analyze() {
      let salary=+document.getElementById('salaryAmount').value;
      let sfreq=document.getElementById('salaryFreq').value;
      let salaryYear=freqToYearly(salary,sfreq);

      let save=parseFloat(document.getElementById('savingsAmount').value)||0;
      let savefreq=document.getElementById('savingsFreq').value;
      let saveYear=freqToYearly(save,savefreq);

      let names=[], amts=[], freqs=[];
      document.querySelectorAll("#expenseList .expName").forEach(e=>names.push(e.value));
      document.querySelectorAll("#expenseList .expAmt").forEach(e=>amts.push(+e.value||0));
      document.querySelectorAll("#expenseList .expFreq").forEach(e=>freqs.push(e.value));
      let totExpYear=0;
      let expBreakdown=[];
      for(let i=0;i<names.length;i++){
        let amtYear=freqToYearly(amts[i],freqs[i]);
        totExpYear+=amtYear;
        expBreakdown.push({name:names[i], amount:amtYear});
      }

      let savePerc=(saveYear/salaryYear)*100;
      let results=`<b>Annualized Salary:</b> ${salaryYear.toFixed(0)}<br>`;
      results+=`<b>Savings Goal:</b> ${saveYear.toFixed(0)} (${savePerc.toFixed(1)}%)<br>`;
      results+=`<b>Total Annual Expenses:</b> ${totExpYear.toFixed(0)} (${(totExpYear/salaryYear*100).toFixed(1)}%)<br>`;
      let rem=salaryYear-saveYear-totExpYear;
      results+=`<b>Remaining for Discretionary/Other:</b> ${rem.toFixed(0)}<br><br>`;

      let sorted=expBreakdown.slice().sort((a,b)=>b.amount-a.amount);
      let sortedTotal=sorted.reduce((sum,e)=>sum+e.amount,0);
      let sortedNames=sorted.map(e=>e.name);
      let sortedAmounts=sorted.map(e=>e.amount);

      results+=`<b>Expense Breakdown by % of Salary:</b><ul>`;
      sorted.forEach(e=>{
        results+=`<li>${e.name}: ${e.amount.toFixed(0)} (${(e.amount/salaryYear*100).toFixed(1)}%)</li>`;
      });
      results+="</ul>";

      if(rem<0){
        let suggest='',cum=rem;
        for(let i=0;i<sorted.length;i++){
          cum+=sorted[i].amount;
          suggest+=`<li>Reduce <b>${sorted[i].name}</b> (${sorted[i].amount.toFixed(0)} / ${((sorted[i].amount/salaryYear)*100).toFixed(1)}%)</li>`;
          if(cum>0) break;
        }
        results+=`<hr><b>EXPENSES ABOVE YOUR INCOME!<br>Cut these costs, in priority order:</b><ul>${suggest}</ul>`;
      }else{
        results+=`<hr><b>Saving meets goal!<br>For more savings, reduce:</b><ul>`;
        sorted.forEach(e=>{
          results+=`<li>${e.name} (${e.amount.toFixed(0)} / ${(e.amount/salaryYear*100).toFixed(1)}%)</li>`;
        });
        results+="</ul>";
      }
      document.getElementById('results').innerHTML=results;

      let pieLabels = sortedNames.concat('Savings','Remaining');
      let pieData = sortedAmounts.concat(saveYear, Math.max(rem,0));
      let pieColors=[];
      for(let i=0;i<sortedAmounts.length;i++){
        let perc=sortedAmounts[i]/sortedTotal;
        pieColors.push(getExpenseColor(i,perc));
      }
      pieColors = pieColors.concat('#33a958','#cccccc');
      if(pieChart) pieChart.destroy();
      pieChart = new Chart(document.getElementById('pieChart').getContext('2d'), {
        type:'pie',
        data:{labels:pieLabels,
          datasets:[{data:pieData, backgroundColor:pieColors}]},
        options:{
          plugins:{legend:{display:true}},
          title:{display:true, text:"Annualized Salary Allocation (%)"}
        }
      });

      let barLabels = pieLabels.slice();
      let barData = pieData.slice();
      let barColors = pieColors.slice();
      if(barChart) barChart.destroy();
      barChart = new Chart(document.getElementById('barChart').getContext('2d'), {
        type:'bar',
        data:{labels:barLabels,
          datasets:[{label:'Annual Amount', data:barData, backgroundColor:barColors}]},
        options:{
          scales:{y:{beginAtZero:true, title:{display:true,text:'Annual Amount'}}}
        }
      });
    }
    function salaryValidate() {
      let val=+document.getElementById('salaryAmount').value;
      let warn=document.getElementById('salaryWarning');
      let btn=document.getElementById('calcBtn');
      if(val<=0 || isNaN(val)){
        warn.textContent='WARNING: Salary amount cannot be empty, zero or negative.';
        warn.style.display='block';
        btn.disabled=true;
      }else{
        warn.textContent='';
        warn.style.display='none';
        btn.disabled=false;
      }
    }
    document.getElementById('calcBtn').addEventListener('click', analyze);
    document.getElementById('salaryAmount').addEventListener('input', salaryValidate);
    window.onload=function(){ salaryValidate(); analyze(); };
  </script>
</body>
</html>
